<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Raster and PSTH · SpikeTriggered.jl</title><meta name="title" content="Raster and PSTH · SpikeTriggered.jl"/><meta property="og:title" content="Raster and PSTH · SpikeTriggered.jl"/><meta property="twitter:title" content="Raster and PSTH · SpikeTriggered.jl"/><meta name="description" content="Documentation for SpikeTriggered.jl."/><meta property="og:description" content="Documentation for SpikeTriggered.jl."/><meta property="twitter:description" content="Documentation for SpikeTriggered.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpikeTriggered.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../spike_stats/">Spike Statistics</a></li><li class="is-active"><a class="tocitem" href>Raster and PSTH</a><ul class="internal"><li><a class="tocitem" href="#Getting-Rasters"><span>Getting Rasters</span></a></li><li><a class="tocitem" href="#Getting-PSTHs"><span>Getting PSTHs</span></a></li><li><a class="tocitem" href="#Getting-smoothed-PSTHs"><span>Getting smoothed PSTHs</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li></ul></li><li><a class="tocitem" href="../reverse_correlation/">Reverse Correlation</a></li><li><a class="tocitem" href="../strf/">Spatiotemporal Receptive Field</a></li><li><a class="tocitem" href="../api/">APIs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Raster and PSTH</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Raster and PSTH</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Raster-and-PSTH"><a class="docs-heading-anchor" href="#Raster-and-PSTH">Raster and PSTH</a><a id="Raster-and-PSTH-1"></a><a class="docs-heading-anchor-permalink" href="#Raster-and-PSTH" title="Permalink"></a></h1><p>Raster plot and <a href="https://en.wikipedia.org/wiki/Peristimulus_time_histogram">peristimulus time histogram</a>(PSTH) are very useful for neural activities to periodic stimuli or repeated trials. Patterns of firing can be easily seen and further analyized when spikes are aligned with the onsets of the stimulus.</p><p>In most cases, spike trains are stored as <code>Vector{T}</code> where <code>T &lt;: Real</code>. Mathematically, it can be represented as series of <a href="https://en.wikipedia.org/wiki/Dirac_delta_function">Dirac delta function</a>:</p><p class="math-container">\[    \operatorname{s}(t) = \sum_i \delta(t - t&#39;_i)\]</p><p>where <span>$t&#39;_i$</span> is the spike times in the spike train vector.</p><h2 id="Getting-Rasters"><a class="docs-heading-anchor" href="#Getting-Rasters">Getting Rasters</a><a id="Getting-Rasters-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Rasters" title="Permalink"></a></h2><p>Rasters will be created as <code>Vector{Vector{T}}</code> using <a href="#SpikeTriggered.Stats.spike_raster"><code>spike_raster</code></a>, where each subvector will be spike times relative to the <strong>stimulus onset</strong>. Besides the spike train, you should at least have the onset time of the stimulus (<code>marker::AbstractVector</code>), and specify the length of time before the onset (<code>head</code>) and <code>duration</code> of the stimulus and time after the stimulus (<code>tail</code>).</p><pre><code class="language-julia hljs">using SpikeTriggered
spike_train = rand(1000) * 50
marker_onset = 0:10:40
raster = spike_raster(spike_train, marker_onset; head=0.5, duration=1.0, tail=0.5)
...</code></pre><h2 id="Getting-PSTHs"><a class="docs-heading-anchor" href="#Getting-PSTHs">Getting PSTHs</a><a id="Getting-PSTHs-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-PSTHs" title="Permalink"></a></h2><p>Histogram style PSTHs can be generated with <a href="#SpikeTriggered.Stats.spike_histogram"><code>spike_histogram</code></a>, and <code>FHist</code> is used under the hook. In order to have finer control and a nonlinear timescale (e.g., when you want to group each trial into 0-100ms and 100ms-500ms as triggering phase and steady phase), <code>edges</code> of the histogram is taken. So, don&#39;t forget to append the last right edge.</p><pre><code class="language-julia hljs">edges = 0:0.01:50.0
psth = spike_histogram(spike_or_raster, edges)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If you need PSTHs for each single trial, you can organize the edges into 2d Matrix as <code>[edges x nTrials]</code>, which results into 2d raster as <code>[n x nTrials]</code>; an easy way to generate such matrix:</p><pre><code class="language-julia hljs">projection = 0:0.001:2
trial_onset = [0,5,10,15,20]
edge_2d = projection .+ trial_onset&#39; # 2d edge matrix
psth_2d = spike_histogram(spike_train, edge_2d)</code></pre></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>the PSTH from raster has an additional kwargs <code>norm=true</code> which will normalized the PSTH by the number of trials.</p></div></div><h2 id="Getting-smoothed-PSTHs"><a class="docs-heading-anchor" href="#Getting-smoothed-PSTHs">Getting smoothed PSTHs</a><a id="Getting-smoothed-PSTHs-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-smoothed-PSTHs" title="Permalink"></a></h2><p>Sometimes, it&#39;s arbitary to find a good bin size, or you just want to smooth the histogram; you can use a kernel function to generate a smooth PSTH using <a href="#SpikeTriggered.Stats.spike_histogram_smoothed"><code>spike_histogram_smoothed</code></a>. Essentially, it is a convolution over time steps provided by <code>projection::AbstractVector</code>.</p><p class="math-container">\[\operatorname{PSTH}(t) = (\operatorname{h} * \operatorname{s})(t) = \sum_i \delta(t - t&#39;_i) h(t - t&#39;_i),\ t \in \text{projection}\]</p><p>where <code>h</code> is the kernel function, <span>$t&#39;_i$</span> is the spike time. By default, it uses a Gaussian kernel function (<a href="#SpikeTriggered.Stats.gaussian_kernel"><code>Stats.gaussian_kernel</code></a>).</p><pre><code class="language-julia hljs"># Gaussian kernel with default sigma = 0.005
spike_histogram_smoothed(spike_or_raster, projection)

# change the Gaussian kernel width
spike_histogram_smoothed(spike_or_raster, projection; σ=0.010)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The kernel function shoudl be defined as <code>(dt; kwargs...) -&gt; ...</code>:</p><pre><code class="language-julia hljs">my_kernel(dt; thresh) = dt &lt; thresh ? 0 : 1
psth = spike_histogram_smoothed(spike_or_raster, projection, my_kernel; thresh=0.5)</code></pre></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>There is also a <code>norm=true</code> flag, to normalize the PSTH by its maximum value, so the PSTH will be between <code>[0, 1]</code>.</p></div></div><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><h3 id="exported-functions"><a class="docs-heading-anchor" href="#exported-functions">exported functions</a><a id="exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#exported-functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpikeTriggered.Stats.spike_raster" href="#SpikeTriggered.Stats.spike_raster"><code>SpikeTriggered.Stats.spike_raster</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spike_raster(spike_train::AbstractVector{T}, markers::AbstractVector; head=0.5, duration=1.0, tail=0.5, offset=true) -&gt; Vector{Vector{T}}</code></pre><p>Create rasters from <code>spike_train</code> and onset times of stimulus (<code>markers</code>), with interval of <code>(marker-head, marker+duration+tail]</code>.</p><p>If <code>offset</code> is <code>true</code>, spike times of each trial be relative to the onset time.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpikeTriggered.Stats.spike_histogram" href="#SpikeTriggered.Stats.spike_histogram"><code>SpikeTriggered.Stats.spike_histogram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spike_histogram(spike_train::AbstractVector{T}, edges::AbstractVector; dtype::Type, kwargs...) -&gt; Vector{T}</code></pre><p>Peri-stimulus time histogram. <code>edges</code> should be length of <code>n+1</code> to create a histogram of length <code>n</code>.</p><p>If <code>spike_train</code> is empty, it will return <code>zeros(T, n)</code></p><p>If <code>counttype</code> is not specified, the returned vector will have same type <code>T</code></p></div></section><section><div><pre><code class="language-julia hljs">spike_histogram(spike_train, edges::AbstractMatrix; kwargs...) -&gt; Matrix{T}</code></pre><p>Peri-stimulus time histogram with multiple trials. <code>edges</code> should be shape of [<code>n+1</code> x nRepeats] to create a histogram of shape [<code>n</code> x nRepeats].</p><p>If <code>dims</code> is specified, trial dimension will be overwrite.</p><p>Additional <code>kwargs</code> will be passed to <code>spike_histogram</code>.</p></div></section><section><div><pre><code class="language-julia hljs">spike_histogram(raster::SpikeRaster{T}, args...; norm=true, kwargs...) -&gt; VecOrMat{T}</code></pre><p>PSTH from averaging rasters.</p><p>If <code>norm</code> is <code>true</code>, PSTH will be normalized by the length of trials.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpikeTriggered.Stats.spike_histogram_smoothed" href="#SpikeTriggered.Stats.spike_histogram_smoothed"><code>SpikeTriggered.Stats.spike_histogram_smoothed</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spike_histogram_smoothed(spike_train::SpikeTrain{T}, projection::AbstractArray, kernel::Function=gaussian_kernel; norm=true, kwargs...) -&gt; Vector{T}</code></pre><p>Generating smoothed curve from spike trains. Equivalent to convolution.</p><p class="math-container">\[\text{PSTH}(t) = (h * s)(t) = \sum_i \delta(t - t&#39;_i) h (t - t&#39;_i),\; t \in \text{proj}\]</p><p>If <code>norm</code> is <code>true</code>, the results will be normalized by the maximum value.</p><p>All <code>kwargs</code> will be passed to <code>kernel</code> function.</p></div></section><section><div><pre><code class="language-julia hljs">spike_histogram_smoothed(raster, args...; kwargs...) where {T &lt;: Real} -&gt; Vector{T}</code></pre><p>Generating smoothed PSTH from rasters.</p><p>If <code>norm</code> is <code>true</code>, PSTH will be normalized to the maximum number; otherwise, it will be divided by the number of trials in the raster.</p></div></section></article><h3 id="utility-functions"><a class="docs-heading-anchor" href="#utility-functions">utility functions</a><a id="utility-functions-1"></a><a class="docs-heading-anchor-permalink" href="#utility-functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpikeTriggered.Stats.gaussian_kernel" href="#SpikeTriggered.Stats.gaussian_kernel"><code>SpikeTriggered.Stats.gaussian_kernel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gaussian_kernel(x::T; σ::T=0.005)</code></pre><p>Inline <a href="https://en.wikipedia.org/wiki/Gaussian_filter">Gaussian function</a>.</p><p class="math-container">\[g(x) = \frac{\exp(-\frac{x^2}{2 σ^2})}{\sqrt{2\pi} σ}\]</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpikeTriggered.Stats.get_histogram_center" href="#SpikeTriggered.Stats.get_histogram_center"><code>SpikeTriggered.Stats.get_histogram_center</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_histogram_center(edges)</code></pre><p>get the center of edge vector. make sure edges are sorted.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpikeTriggered.Stats.histogram_fhist" href="#SpikeTriggered.Stats.histogram_fhist"><code>SpikeTriggered.Stats.histogram_fhist</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">histogram_fhist(u_arr, edges; kwargs...) -&gt; Vector</code></pre><p>Count histogram using <code>FHist.Hist1D</code>, which has similar performance as <code>GSL</code>.</p><p><code>kwargs</code> will be relayed to <code>FHist.Hist1D</code>; for example, one could set element type of the histogram to <code>Float32</code> by passing <code>counttype=Float32</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpikeTriggered.Stats.histogram_gsl" href="#SpikeTriggered.Stats.histogram_gsl"><code>SpikeTriggered.Stats.histogram_gsl</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">histogram_gsl(u_arr, edges) where {T &lt;: Real}</code></pre><p>Count histogram by providing the edges. If provides <code>n+1</code> edges, it would return <code>n</code> length histogram. Edges would work as: left bound &lt;= value &lt; right bound.</p><p><strong>Arguments</strong></p><ul><li><code>u_arr</code>: a vector of values</li><li><code>edges</code>: a vector of edges</li></ul><p>Note: StatsBase.Histogram is slower than GSL but with less memory footprint.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../spike_stats/">« Spike Statistics</a><a class="docs-footer-nextpage" href="../reverse_correlation/">Reverse Correlation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Friday 23 August 2024 19:59">Friday 23 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
